<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ·»åŠ ä»£å¸åˆ° MetaMask</title>
    <style>
        /* ç®€å•çš„æŒ‰é’®æ ·å¼ï¼Œä½ å¯ä»¥éšé‡ä¿®æ”¹ */
        .add-btn {
            background-color: #f6851b; /* MetaMask æ©™è‰² */
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: Arial, sans-serif;
            font-weight: bold;
        }
        .add-btn:hover {
            background-color: #e2761b;
        }
    </style>
</head>
<body>

    <button class="add-btn" onclick="addToken()">
        æ·»åŠ ä»£å¸åˆ° MetaMask ğŸ¦Š
    </button>

    <script>
        async function addToken() {
            // 1. ä½ çš„ä»£å¸é…ç½®ä¿¡æ¯
            const tokenAddress = '0xaccCCc9B9D342adD1001ba4F451716136E39394C'; // ä½ æä¾›çš„åœ°å€
            const tokenSymbol = 'MIA';    // ã€é‡è¦ã€‘è¯·ä¿®æ”¹ä¸ºä½ çš„ä»£å¸ç¬¦å· (ä¾‹å¦‚: BTC, USDT)
            const tokenDecimals = 18;      // ã€é‡è¦ã€‘è¯·ä¿®æ”¹ä¸ºä½ çš„ä»£å¸ç²¾åº¦ (é€šå¸¸æ˜¯18)
            
            // 2. ä»£å¸å›¾æ ‡é“¾æ¥
            // ç›®å‰ä½¿ç”¨å ä½å›¾ã€‚æ­£å¼ä½¿ç”¨æ—¶ï¼Œè¯·æ›¿æ¢ä¸ºä½ çš„ HTTPS å›¾ç‰‡é“¾æ¥ (æ¯”å¦‚ GitHub raw é“¾æ¥æˆ–ä½ çš„å®˜ç½‘å›¾ç‰‡)
            const tokenImage = 'https://github.com/wcnmdbxhl/mytokenset/blob/main/mia.jpg?raw=true'; 

            try {
                // æ£€æŸ¥æ˜¯å¦å®‰è£…äº† MetaMask
                const { ethereum } = window;
                if (!ethereum) {
                    alert('è¯·å…ˆå®‰è£… MetaMask é’±åŒ…ï¼');
                    return;
                }

                // å‘é€è¯·æ±‚
                const wasAdded = await ethereum.request({
                    method: 'wallet_watchAsset',
                    params: {
                        type: 'ERC20', 
                        options: {
                            address: tokenAddress, 
                            symbol: tokenSymbol, 
                            decimals: tokenDecimals, 
                            image: tokenImage, 
                        },
                    },
                });

                if (wasAdded) {
                    console.log('æˆåŠŸï¼ä»£å¸å·²æ·»åŠ ã€‚');
                    alert('ä»£å¸æ·»åŠ æˆåŠŸï¼è¯·æŸ¥çœ‹ä½ çš„é’±åŒ…ã€‚');
                } else {
                    console.log('ç”¨æˆ·å–æ¶ˆäº†æ“ä½œã€‚');
                }
            } catch (error) {
                console.error(error);
                alert('å‘ç”Ÿé”™è¯¯ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°ã€‚');
            }
        }
    </script>

</body>
</html>